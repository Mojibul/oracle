-- CREATE PRODUCT_CATEGORY TABLE
CREATE TABLE PRODUCT_CATEGORY(
 CATEGORY_ID NUMBER(15,0) NOT NULL ENABLE
,CATEGORY_PARENT_ID NUMBER(15,0) 
,CATEGORY_NAME VARCHAR2(30 BYTE) NOT NULL ENABLE
,CATEGORY_DESCRIPTION VARCHAR2(50 BYTE)
,LANGUAGE_CODE VARCHAR2(5 BYTE)

);

-- CREATE PRODUCT_CAT_BOOKS 

CREATE TABLE PRODUCT_CAT_BOOKS  (
CATEGORY_ID NUMBER(15, 0) NOT NULL ENABLE
,CATEGORY_PARENT_ID NUMBER(15, 0)
,CATEGORY_NAME VARCHAR2(30 BYTE) NOT NULL ENABLE
,CATEGORY_DESCRIPTION VARCHAR2(50 BYTE)
,LANGUAGE_CODE VARCHAR2(5 BYTE)
);

-- INSERT SOME SAMPLE DATA IN PRODUCT_CATEGORY TABLE


begin
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (1,null,'Media','Books, Music, and Movies','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (2,null,'Office','Office Supplies','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (3,null,'Electronics','Consumer Electronics','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (4,3,'Audio and Video','Audio and Video','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (5,3,'Camera and Photo','Camera and Photo','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (6,3,'Cell Phones','Cell Phones and Service','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (7,3,'Games','Computer and Video Games','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (8,1,'Books','Books','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (9,1,'DVDs','DVDs','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (10,1,'Periodicals','Magazines and Newspapers','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (11,1,'Music','CDs','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (12,2,'Hardware','Computers','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (13,2,'Supplies','Office Supplies','EN');
Insert into PRODUCT_CATEGORY (CATEGORY_ID,CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE) values (14,2,'Software','Software','EN');
COMMIT;
end;

-- CHECK PRODUCT_CATEGORY DATA
SELECT * FROM PRODUCT_CATEGORY;

--- DELETE ROWS FROM PRODUCT_CATEGORY AND  DELETED ROWS ARE INSERT INTO PRODUCT_CAT_BOOKS TABLE 

DECLARE
 TYPE ttProductCategory IS TABLE OF PRODUCT_CATEGORY%ROWTYPE;
 delrows TTPRODUCTCATEGORY;
BEGIN
 DELETE PRODUCT_CATEGORY WHERE UPPER(CATEGORY_DESCRIPTION) LIKE '%BOOK%'
 RETURNING CATEGORY_ID, CATEGORY_PARENT_ID,CATEGORY_NAME,CATEGORY_DESCRIPTION,LANGUAGE_CODE BULK COLLECT INTO delrows;
 FORALL i IN 1 .. delrows.count
  INSERT INTO PRODUCT_CAT_BOOKS
  VALUES delrows(i);
END;

-- VERIFY PRODUCT_CATEGORY AND PRODUCT_CAT_BOOKS TABLE
SELECT * FROM PRODUCT_CATEGORY WHERE  UPPER(CATEGORY_DESCRIPTION) LIKE '%BOOK%';

SELECT * FROM PRODUCT_CAT_BOOKS ;
